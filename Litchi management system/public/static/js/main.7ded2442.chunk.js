(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{1059:function(e,t,a){},1116:function(e,t,a){},1247:function(e,t,a){},1248:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),s=a.n(c),l=a(22),o=a(23),i=a(26),u=a(24),d=a(25),p=a(120),m=a(124),h=a(50),f=(a(363),a(125)),g=(a(364),a(74)),y=(a(88),a(32)),v=(a(109),a(5)),b=(a(176),a(45)),E=(a(99),a(43)),O=(a(207),a(41)),w=a(16),k=a.n(w),j=a(250),x=a(355),C=a.n(x);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(n,r){("GET"===a?C.a.get(e,{params:t}):C.a.post(e,t)).then((function(e){n(e.data)})).catch((function(e){O.a.error("\u8bf7\u6c42\u9519\u8bef: "+e.message)}))}))}var N=function(e,t){return S("/login",{username:e,password:t},"POST")},I=function(e){return S("/manage/category/list",{parentId:e})},A=function(e){return S("/manage/category/add",{categoryName:e.categoryName,parentId:e.parentId},"POST")},_=function(e){return S("/manage/category/update",{categoryId:e.categoryId,categoryName:e.categoryName},"POST")},M=function(e,t){return S("/manage/product/list",{pageNum:e,pageSize:t})},U=function(e,t,a,n){return S("/manage/product/search",Object(j.a)({pageNum:e,pageSize:t},a,n))},D=function(e){return S("/manage/category/info",{categoryId:e})},T=function(e,t){return S("/manage/product/updateStatus",{productId:e,status:t},"POST")},V=function(e){return S("/manage/img/delete",{name:e},"POST")},P=function(e,t,a,n,r,c,s){return S("/manage/product/add",{categoryId:e,pCategoryId:t,name:a,desc:n,price:r,detail:c,imgs:s},"POST")},R=function(e,t,a,n,r,c,s,l){return S("/manage/product/update",{_id:e,categoryId:t,pCategoryId:a,name:n,desc:r,price:c,detail:s,imgs:l},"POST")},L=function(e){return S("/manage/role/add",{roleName:e},"POST")},F=function(){return S("/manage/role/list")},B=function(e,t,a,n){return S("/manage/role/update",{_id:e,menus:t,auth_time:a,auth_name:n},"POST")},z=function(){return S("/manage/user/list")},K=function(e){return S("/manage/user/"+(e.password?"add":"update"),e,"POST")},Y=function(e){return S("/manage/user/delete",{userId:e},"POST")},q="auth_success",W="error_msg",J="receive_user",G="reset_user",H="receive_wheather",Q="receive_categorys",Z="addcategory_success",$="updatecategory_success",X="receive_products",ee="addproduct_success",te="updateproduct_success",ae="receive_role_list",ne="receive_user_list",re=a(263),ce=a.n(re),se={saveUser:function(e){ce.a.set("user_key",e)},getUser:function(){return ce.a.get("user_key")},removeUser:function(){ce.a.remove("user_key")}},le=function(e){return{type:W,data:e}},oe=function(e){return{type:X,data:e}},ie=function(e){return{type:ae,data:e}},ue=function(e){return{type:ne,data:e}},de=function(e){return function(t){var a,n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(I(e));case 2:a=r.sent,n=a.data,0===a.status&&t({type:Q,data:n});case 5:case"end":return r.stop()}}))}},pe=function(e){var t=e.parentId,a=e.categoryName;return function(e){var n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(A({parentId:t,categoryName:a}));case 2:0===(n=r.sent).status&&e({type:Z,data:n});case 4:case"end":return r.stop()}}))}},me=function(){return function(e){var t;return k.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k.a.awrap(F());case 2:0===(t=a.sent).status?e(ie(t.data)):O.a.error("\u83b7\u53d6\u5931\u8d25");case 4:case"end":return a.stop()}}))}},he=(a(638),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handlSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){if(e)console.log("\u6821\u9a8c\u5931\u8d25");else{var n=t.username,r=t.password;a.props.login(n,r)}}))},a.validatorPwd=function(e,t,a){t?t.length<4?a("\u5bc6\u7801\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e4\u4f4d"):t.length>12?a("\u5bc6\u7801\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e12\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?a():a("\u5bc6\u7801\u5fc5\u987b\u662f\u5b57\u6bcd\u6216\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210!"):a("\u5fc5\u987b\u586b\u5199\u5bc6\u7801")},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){0===this.props.user.status&&this.props.history.replace("/")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.user;return t&&0===t.status?r.a.createElement(m.a,{to:this.props.user.path}):r.a.createElement("div",{className:"login"},r.a.createElement(f.a,{type:"flex",align:"middle",justify:"space-around"},r.a.createElement(g.a,{type:"flex",align:"left",className:"form",span:6},r.a.createElement(b.a,{onSubmit:this.handlSubmit},r.a.createElement("h1",{className:"login_text"},"Login"),r.a.createElement(b.a.Item,null,e("username",{rules:[{required:!0,whitespace:!0,message:"\u5fc5\u987b\u586b\u5199!"},{whitespace:!0,message:"\u4e0d\u80fd\u6709\u7a7a\u683c\uff01"},{min:4,message:"\u6700\u5c0f\u56db\u4f4d\uff01"},{max:12,message:"\u6700\u957f12\u4f4d!"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u5fc5\u987b\u662f\u5b57\u6bcd\u6216\u6570\u5b57\u6216\u4e0b\u5212\u7ebf!"}]})(r.a.createElement(E.a,{className:"Input",size:"large",placeholder:"\u7528\u6237\u540d"}))),r.a.createElement(b.a.Item,null,e("password",{rules:[{validator:this.validatorPwd}]})(r.a.createElement(E.a,{className:"Input",size:"large",type:"password",placeholder:"\u5bc6\u7801"}))),r.a.createElement(b.a.Item,null,r.a.createElement(y.a,{htmlType:"submit",className:"Button",type:"default",size:"large",shape:"round"},r.a.createElement(v.a,{type:"login"}),"\u767b\u5f55")),1===t.status?r.a.createElement("span",{className:"errorMsg"},t.msg):null))))}}]),t}(n.Component)),fe=b.a.create()(he),ge=Object(h.b)((function(e){return{user:e.user}}),{login:function(e,t){return e?t?function(a){var n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(N(e,t));case 2:0===(n=r.sent).status?(se.saveUser(n.data),a({type:q,data:n})):a(le(n));case 4:case"end":return r.stop()}}))}:le("\u5bc6\u7801\u9519\u8bef"):le("\u5fc5\u987b\u586b\u5199\u7528\u6237\u540d")}})(fe),ye=(a(293),a(107)),ve=a(203),be=a.n(ve),Ee=(a(714),a(146)),Oe=[{title:"\u9996\u9875",key:"/home",icon:"home"},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]}],we=ye.a.Sider,ke=Ee.a.SubMenu,je=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={collapsed:!1},a.onCollapse=function(e){a.setState({collapsed:e})},a.getMenuNodes=function(e){return e.map((function(e){if(a.hasAuth(e)){if(e.children){var t=a.props.location.pathname;return e.children.find((function(e){return 0===t.indexOf(e.key)}))&&(a.openKey=e.key),r.a.createElement(ke,{key:e.key,title:r.a.createElement("span",null,r.a.createElement(v.a,{type:e.icon}),r.a.createElement("span",null,e.title))},a.getMenuNodes(e.children))}return r.a.createElement(Ee.a.Item,{key:e.key},r.a.createElement(p.b,{to:e.key},r.a.createElement(v.a,{type:e.icon}),r.a.createElement("span",null,e.title)))}}))},a.hasAuth=function(e){var t=e.key,a=e.isPublic,n=se.getUser().role.menus;return!("admin"!==se.getUser().username&&!a&&-1===n.indexOf(t))||!!e.children&&!!e.children.find((function(e){return-1!==n.indexOf(e.key)}))},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(Oe)}},{key:"render",value:function(){var e=this.props.location.pathname;0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return r.a.createElement(we,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},r.a.createElement("div",{className:"logo"}),r.a.createElement(Ee.a,{theme:"dark",selectedKeys:[e],defaultOpenKeys:[t],mode:"inline"},this.menuNodes))}}]),t}(n.Component),xe=Object(m.g)(je),Ce=(a(181),a(72)),Se=(a(724),ye.a.Header),Ne=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1},a.handleOk=function(){be.a.remove("userid"),a.props.history.replace("/login"),a.setState({visible:!1})},a.handleCancel=function(){a.setState({visible:!1})},a.showModal=function(){a.setState({visible:!0})},a.getTitle=function(){var e,t=a.props.history.location.pathname;return Oe.forEach((function(a){if(a.key===t)e=a.title;else if(a.children){var n=a.children.find((function(e){return 0===t.indexOf(e.key)}));n&&(e=n.title)}})),e},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.user,t=this.getTitle();return r.a.createElement(Se,{className:"header"},r.a.createElement("div",{className:"header-top"},r.a.createElement("span",null,"\u6b22\u8fce",e.username),"\xa0\xa0\xa0",r.a.createElement(y.a,{className:"logout",type:"danger",onClick:this.showModal},"\u9000\u51fa")),r.a.createElement("hr",null),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("div",{className:"header-bottom-left"},t)),r.a.createElement(Ce.a,{visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,centered:!0,mask:!0},r.a.createElement("h1",null,"\u786e\u5b9a\u8981\u9000\u51fa\u767b\u9646\u5417")))}}]),t}(n.Component),Ie=Object(h.b)((function(e){return{user:e.user}}))(Object(m.g)(Ne)),Ae=(a(725),a(726),a(175)),_e=(a(96),a(42)),Me=(a(730),a(266)),Ue=(a(1249),a(553)),De=a(21),Te=a.n(De),Ve=a(68),Pe=a(541),Re=a.n(Pe),Le=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=(new Re.a).createView().source([{month:"Jan",a:7,b:3.9,c:5.9},{month:"Feb",a:6.9,b:4.2,c:1.9},{month:"Mar",a:9.5,b:5.7,c:3.9},{month:"Apr",a:14.5,b:8.5,c:5.5},{month:"May",a:18.4,b:11.9,c:8.9},{month:"Jun",a:21.5,b:15.2,c:10},{month:"Jul",a:25.2,b:17,c:12.9},{month:"Aug",a:26.5,b:16.6,c:15.9},{month:"Sep",a:23.3,b:14.2,c:20.7},{month:"Oct",a:18.3,b:10.3,c:25.9},{month:"Nov",a:13.9,b:6.6,c:30.9},{month:"Dec",a:9.6,b:4.8,c:35.9}]);e.transform({type:"fold",fields:["a","b","c"],key:"city",value:"temperature"});return r.a.createElement("div",{style:{float:"right",width:750,height:300}},r.a.createElement(Ve.Chart,{height:250,data:e,scale:{month:{range:[0,1]}},forceFit:!0},r.a.createElement(Ve.Legend,null),r.a.createElement(Ve.Axis,{name:"month"}),r.a.createElement(Ve.Axis,{name:"temperature",label:{formatter:function(e){return"".concat(e,"\u4e07\u4e2a")}}}),r.a.createElement(Ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(Ve.Geom,{type:"line",position:"month*temperature",size:2,color:"city",shape:"smooth"}),r.a.createElement(Ve.Geom,{type:"point",position:"month*temperature",size:4,shape:"circle",color:"city",style:{stroke:"#fff",lineWidth:1}})))}}]),t}(r.a.Component),Fe=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",marginLeft:-30}},r.a.createElement(Ve.Chart,{height:338,data:[{year:"1 \u6708",sales:38},{year:"2 \u6708",sales:52},{year:"3 \u6708",sales:61},{year:"4 \u6708",sales:145},{year:"5 \u6708",sales:48},{year:"6 \u6708",sales:38},{year:"7 \u6708",sales:28},{year:"8 \u6708",sales:38},{year:"59 \u6708",sales:68},{year:"10 \u6708",sales:38},{year:"11 \u6708",sales:58},{year:"12 \u6708",sales:38}],scale:{sales:{tickInterval:20}},forceFit:!0},r.a.createElement(Ve.Axis,{name:"year"}),r.a.createElement(Ve.Axis,{name:"sales"}),r.a.createElement(Ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(Ve.Geom,{type:"interval",position:"year*sales"})))}}]),t}(r.a.Component),Be=(a(735),Ue.a.RangePicker),ze=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isVisited:!0},a.handleChange=function(e){return function(){return a.setState({isVisited:e})}},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.isVisited;return r.a.createElement("div",{className:"home"},r.a.createElement(_e.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:r.a.createElement(v.a,{style:{color:"rgba(0,0,0,.45)"},type:"question-circle"}),style:{width:250},headStyle:{color:"rgba(0,0,0,.45)"}},r.a.createElement(Me.a,{value:1128163,suffix:"\u4e2a",style:{fontWeight:"bolder"}}),r.a.createElement(Me.a,{value:15,valueStyle:{fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(v.a,{style:{color:"red",marginLeft:10},type:"arrow-down"}))}),r.a.createElement(Me.a,{value:10,valueStyle:{fontSize:15},prefix:"\u65e5\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(v.a,{style:{color:"#3f8600",marginLeft:10},type:"arrow-up"}))})),r.a.createElement(Le,null),r.a.createElement(_e.a,{className:"home-content",title:r.a.createElement("div",{className:"home-menu"},r.a.createElement("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0)},"\u8bbf\u95ee\u91cf"),r.a.createElement("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1)},"\u9500\u552e\u91cf")),extra:r.a.createElement(Be,{defaultValue:[Te()("2019/01/01","YYYY/MM/DD"),Te()("2019/06/01","YYYY/MM/DD")],format:"YYYY/MM/DD"})},r.a.createElement(_e.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0,height:275},extra:r.a.createElement(v.a,{type:"reload"})},r.a.createElement(Fe,null)),r.a.createElement(_e.a,{title:"\u4efb\u52a1",extra:r.a.createElement(v.a,{type:"reload"}),className:"home-table-right"},r.a.createElement(Ae.a,null,r.a.createElement(Ae.a.Item,{color:"green"},"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"),r.a.createElement(Ae.a.Item,{color:"green"},"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"),r.a.createElement(Ae.a.Item,{color:"green"},r.a.createElement("p",null,"\u8054\u8c03\u63a5\u53e3"),r.a.createElement("p",null,"\u529f\u80fd\u9a8c\u6536")),r.a.createElement(Ae.a.Item,{color:"green"},r.a.createElement("p",null,"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"),r.a.createElement("p",null,"\u6743\u9650\u9a8c\u8bc1"),r.a.createElement("p",null,"\u9875\u9762\u6392\u7248"))))))}}]),t}(n.Component),Ke=a(173),Ye=a.n(Ke),qe=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20],inventorys:[15,30,46,20,20,40]},a.getOption=function(){var e=a.state;return{title:{text:""},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e.sales},{name:"\u5e93\u5b58",type:"bar",data:e.inventorys}]}},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_e.a,null,r.a.createElement(Ye.a,{option:this.getOption(),style:{height:300}})))}}]),t}(n.Component),We=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20],inventorys:[15,30,46,20,20,40]},a.getOption=function(){var e=a.state;return{tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e.sales},{name:"\u5e93\u5b58",type:"line",data:e.inventorys}]}},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_e.a,null,r.a.createElement(Ye.a,{option:this.getOption(),style:{height:300}})))}}]),t}(n.Component),Je=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getOption=function(){return{backgroundColor:"#2c343c",title:{text:"\u997c\u56fe",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:250,name:"\u886c\u886b"},{value:200,name:"\u7f8a\u6bdb\u886b"},{value:360,name:"\u96ea\u7eba\u886b"},{value:300,name:"\u88e4\u5b50"},{value:200,name:"\u9ad8\u8ddf\u978b"},{value:200,name:"\u889c\u5b50"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{color:"rgba(255, 255, 255, 0.3)"},labelLine:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20},itemStyle:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_e.a,null,r.a.createElement(Ye.a,{option:this.getOption(),style:{height:300}})))}}]),t}(n.Component),Ge=(a(246),a(123)),He=(a(241),a(67)),Qe=(a(1059),function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("button",Object.assign({},this.props,{className:"link-button"}))}}]),t}(n.Component)),Ze=5,$e="http://localhost:5000/upload/",Xe=He.a.Option,et=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={current:"1",searchType:"productName",searchName:""},a.changePage=function(e){a.props.getProducts(e,Ze),a.pageNum=e},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\uffe5"+e}},{title:"\u72b6\u6001",width:"5%",render:function(t){var a=t.status,n=t._id,c=1===a?2:1;return r.a.createElement("span",null,r.a.createElement(y.a,{onClick:function(){return e.props.getUpdateStatus(n,c,e.pageNum,Ze)},type:"default"},1===a?"\u4e0b\u3000\u67b6":"\u4e0a\u3000\u67b6"),r.a.createElement(y.a,{type:"link"},1===a?"\u5728\u3000\u552e":"\u5df2\u4e0b\u67b6"))}},{title:"\u64cd\u4f5c",width:"10%",render:function(t){return r.a.createElement("span",null,r.a.createElement(Qe,{onClick:function(){return e.props.history.push("/product/detail",{product:t})}},"\u8be6\u60c5"),r.a.createElement("br",null),r.a.createElement(Qe,{onClick:function(){return e.props.history.push("/product/addupdateitem",t)}},"\u4fee\u6539"))}}]}},{key:"componentDidMount",value:function(){var e=void 0===this.pageNum?1:this.pageNum;this.props.getProducts(e,Ze)}},{key:"render",value:function(){var e=this,t=this.state,a=t.searchType,n=t.searchName,c=r.a.createElement("span",null,r.a.createElement(He.a,{value:a,onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(Xe,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(Xe,{value:"productDesc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(E.a,{placeholder:"\u8f93\u5165\u5173\u952e\u5b57\uff0c\u5982\u679c\u6ca1\u6709\u5185\u5bb9\u5219\u641c\u7d22\u5168\u90e8\u3002",value:n,style:{width:300,margin:"0 10px"},onChange:function(t){return e.setState({searchName:t.target.value})}}),r.a.createElement(y.a,{type:"primary",onClick:function(){e.props.getProducts(1,Ze,a,n)}},r.a.createElement(v.a,{type:"file-search"}),"\u641c\u7d22")),s=r.a.createElement(y.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdateitem")}},r.a.createElement(v.a,{type:"plus"}),"\u6dfb\u52a0"),l=this.props.products;if(1===l.status)return this.loading=!0,null;this.loading=!1;var o=l.data,i=o.list,u=o.total,d=i;return r.a.createElement(_e.a,{title:c,extra:s},r.a.createElement(Ge.a,{rowKey:"_id",loading:this.loading,dataSource:d,columns:this.columns,pagination:{total:u,defaultPageSize:Ze,showQuickJumper:!0,onChange:this.changePage}}))}}]),t}(n.Component),tt=Object(h.b)((function(e){return{products:e.products}}),{getProducts:function(e,t,a,n){return function(r){var c;return k.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!n){s.next=6;break}return s.next=3,k.a.awrap(U(e,t,a,n));case 3:c=s.sent,s.next=9;break;case 6:return s.next=8,k.a.awrap(M(e,t));case 8:c=s.sent;case 9:0===c.status&&r(oe(c));case 10:case"end":return s.stop()}}))}},getUpdateStatus:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0;return function(r){var c;return k.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,k.a.awrap(T(e,t));case 2:if(0!==s.sent.status){s.next=8;break}return s.next=6,k.a.awrap(M(a,n));case 6:0===(c=s.sent).status&&(r(oe(c)),O.a.success("\u66f4\u6539\u6210\u529f"));case 8:case"end":return s.stop()}}))}}})(et),at=(a(1114),a(361)),nt=(a(1116),at.a.Item),rt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={categoryName1:"",categoryName2:""},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e,t,a,n,r,c,s,l;return k.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e=this.props.location.state.product,t=e.pCategoryId,a=e.categoryId,"0"!==t){o.next=9;break}return o.next=4,k.a.awrap(D(a));case 4:n=o.sent,r=n.data.name,this.setState({categoryName1:r}),o.next=15;break;case 9:return o.next=11,k.a.awrap(Promise.all([D(t),D(a)]));case 11:c=o.sent,s=c[0].data.name,l=c[1].data.name,this.setState({categoryName1:s,categoryName2:l});case 15:case"end":return o.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=r.a.createElement(Qe,{onClick:function(){return e.props.history.goBack()}},r.a.createElement(v.a,{type:"rollback"}),"\xa0\xa0\u8fd4\u56de\u5546\u54c1\u5217\u8868"),a=this.props.location.state.product,n=a.imgs,c=a.name,s=a.desc,l=a.price,o=a.detail,i=this.state,u=i.categoryName1,d=i.categoryName2;return r.a.createElement(_e.a,{title:t},r.a.createElement(at.a,null,r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u5546\u54c1\u540d\u79f0\uff1a"),r.a.createElement("span",null,c)),r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u5546\u54c1\u63cf\u8ff0\uff1a"),r.a.createElement("span",null,s)),r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u5546\u54c1\u4ef7\u683c\uff1a"),r.a.createElement("span",null,l)),r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u6240\u5c5e\u5206\u7c7b\uff1a"),r.a.createElement("span",null,u," ",d?"--\x3e"+d:"")),r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u5546\u54c1\u56fe\u7247\uff1a"),r.a.createElement("span",null,n.length>0?n.map((function(e){return r.a.createElement("img",{key:e,src:$e+e,style:{width:150,height:"auto"},alt:"\u56fe\u7247"})})):r.a.createElement("span",null,"\u6ca1\u6709\u56fe\u7247"))),r.a.createElement(nt,null,r.a.createElement("span",{className:"title"},"\u5546\u54c1\u8be6\u60c5\uff1a"),r.a.createElement("span",{dangerouslySetInnerHTML:{__html:o}}))))}}]),t}(n.Component),ct=(a(1117),a(555)),st=a(126),lt=a(168),ot=(a(1250),a(554));function it(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var ut=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(e){return k.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("handlPreview()",e),e.url||e.preview){t.next=5;break}return t.next=4,k.a.awrap(it(e.originFileObj));case 4:e.preview=t.sent;case 5:a.setState({previewImage:e.url||e.preview,previewVisible:!0});case 6:case"end":return t.stop()}}))},a.handleChange=function(e){var t,n,r,c,s,l;return k.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.file,n=e.fileList,console.log("status"+t.status),"done"!==t.status){o.next=7;break}0===(r=t.response).status?(O.a.success("\u4e0a\u4f20\u6210\u529f"),c=r.data,s=c.name,l=c.url,(t=n[n.length-1]).name=s,t.url=l):O.a.error("\u4e0a\u4f20\u5931\u8d25"),o.next=12;break;case 7:if("removed"!==t.status){o.next=12;break}return o.next=10,k.a.awrap(V(t.name));case 10:0===o.sent.status?O.a.success("\u5220\u9664\u6210\u529f"):O.a.error("\u5220\u9664\u56fe\u7247\u5931\u8d25");case 12:a.setState({fileList:n});case 13:case"end":return o.stop()}}))},a.getImgs=function(){return a.state.fileList.map((function(e){return e.name}))};var n=[],r=a.props.imgs;return r&&r.length>0&&(n=r.map((function(e,t){return{uid:-t,name:e,status:"done",url:$e+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:n},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,c=r.a.createElement("div",null,r.a.createElement(v.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload"));return r.a.createElement("div",{className:"clearfix"},r.a.createElement(ot.a,{action:"/manage/img/upload",accept:"image/*",name:"image",listType:"picture-card",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange},n.length>=8?null:c),r.a.createElement(Ce.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(n.Component),dt=a(144),pt=a(547),mt=a(548),ht=a.n(mt),ft=a(549),gt=a.n(ft),yt=(a(1244),function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).onEditorStateChange=function(e){a.setState({editorState:e})},a.getDetail=function(){return ht()(Object(dt.convertToRaw)(a.state.editorState.getCurrentContent()))};var n=a.props.detail;if(n){var r=gt()(n);if(r){var c=dt.ContentState.createFromBlockArray(r.contentBlocks),s=dt.EditorState.createWithContent(c);a.state={editorState:s}}}else a.state={editorState:dt.EditorState.createEmpty()};return a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement("div",null,r.a.createElement(pt.Editor,{editorState:e,editorStyle:{border:"1px solid #ccc",padding:"0px 10px",minHeight:300},onEditorStateChange:this.onEditorStateChange}))}}]),t}(n.Component)),vt=b.a.Item,bt=E.a.TextArea,Et=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={options:[]},a.initOptions=function(e){var t,n,r,c,s,l,o;return k.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),n=Object(lt.a)(a),r=n.isUpdate,c=n.product,s=c.pCategoryId,!r||"0"===s){i.next=10;break}return i.next=6,k.a.awrap(a.getCategorys(s));case 6:l=i.sent,o=l.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),t.find((function(e){return e.value===s})).children=o;case 10:a.setState({options:t});case 11:case"end":return i.stop()}}))},a.getCategorys=function(e){var t,n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(I(e));case 2:if(0!==(t=r.sent).status){r.next=10;break}if(n=t.data,"0"!==e){r.next=9;break}a.initOptions(n),r.next=10;break;case 9:return r.abrupt("return",n);case 10:case"end":return r.stop()}}))},a.loadData=function(e){var t,n,r;return k.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return(t=e[e.length-1]).loading=!0,c.next=4,k.a.awrap(a.getCategorys(t.value));case 4:n=c.sent,t.loading=!1,n&&n.length>0?(r=n.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),t.children=r):t.isLeaf=!0,a.setState(Object(st.a)({},a.state.options));case 8:case"end":return c.stop()}}))},a.validatorPrice=function(e,t,a){1*t<=0?a("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0"):a()},a.submit=function(){a.props.form.validateFields((function(e,t){if(!e){var n=t.name,r=t.desc,c=t.price,s=t.categoryIds,l=s[0],o=s[1],i=a.pw.current.getImgs(),u=a.editor.current.getDetail();if(!0===a.isUpdate){var d=a.props.location.state._id;a.props.getUpdateProductStatus(d,o,l,n,r,c,u,i),a.props.history.goBack()}else a.props.getAaddProductStatus(o,l,n,r,c,u,i),a.props.history.goBack()}}))},a.pw=r.a.createRef(),a.editor=r.a.createRef(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"render",value:function(){var e=this,t=this.isUpdate,a=this.product,n=a.categoryId,c=a.pCategoryId,s=a.imgs,l=a.detail,o=[];t&&("0"===c?o.push(n):(o.push(c),o.push(n)));var i=r.a.createElement(Qe,{onClick:function(){return e.props.history.goBack()}},r.a.createElement(v.a,{type:"rollback"}),"\xa0\xa0\u8fd4\u56de"),u=this.props.form.getFieldDecorator;return r.a.createElement(_e.a,{title:i,extra:t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"},r.a.createElement(b.a,{labelCol:{span:2},wrapperCol:{span:8}},r.a.createElement(vt,{label:"\u5546\u54c1\u540d\u79f0"},u("name",{initialValue:a.name,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5199\u5546\u54c1\u540d\u79f0"}]})(r.a.createElement(E.a,{className:"addInput",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(vt,{label:"\u5546\u54c1\u63cf\u8ff0"},u("desc",{initialValue:a.desc,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5199\u5546\u54c1\u63cf\u8ff0"}]})(r.a.createElement(bt,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autoSize:!0}))),r.a.createElement(vt,{label:"\u5546\u54c1\u4ef7\u683c"},u("price",{initialValue:a.price,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5199\u5546\u54c1\u4ef7\u683c"},{validator:this.validatorPrice}]})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143",type:"number"}))),r.a.createElement(vt,{label:"\u5546\u54c1\u7c7b\u578b"},u("categoryIds",{initialValue:o,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5199\u5546\u54c1\u63cf\u8ff0"}]})(r.a.createElement(ct.a,{options:this.state.options,loadData:this.loadData}))),r.a.createElement(vt,{label:"\u5546\u54c1\u56fe\u7247"},r.a.createElement("div",null,"\u5546\u54c1\u56fe\u7247"),r.a.createElement(ut,{ref:this.pw,imgs:s})),r.a.createElement(vt,{label:"\u5546\u54c1\u8be6\u60c5",labelCol:{span:2},wrapperCol:{span:20}},r.a.createElement(yt,{ref:this.editor,detail:l})),r.a.createElement(vt,null,r.a.createElement(y.a,{type:"primary",onClick:this.submit},"\u63d0\u4ea4"))))}}]),t}(n.Component),Ot=Object(h.b)((function(e){return{productStatus:e.productStatus}}),{getAaddProductStatus:function(e,t,a,n,r,c,s){return function(l){var o;return k.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,k.a.awrap(P(e,t,a,n,r,c,s));case 2:0===(o=i.sent).status?(l((u=o.status,{type:ee,data:u})),O.a.success("\u6dfb\u52a0\u5546\u54c1\u6210\u529f")):O.a.error("\u6dfb\u52a0\u5546\u54c1\u5931\u8d25");case 4:case"end":return i.stop()}var u}))}},getUpdateProductStatus:function(e,t,a,n,r,c,s,l){return function(o){var i;return k.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,k.a.awrap(R(e,t,a,n,r,c,s,l));case 2:0===(i=u.sent).status?(o((d=i.status,{type:te,data:d})),O.a.success("\u4fee\u6539\u5546\u54c1\u6210\u529f")):O.a.error("\u4fee\u6539\u5546\u54c1\u5931\u8d25");case 4:case"end":return u.stop()}var d}))}}})(b.a.create()(Et)),wt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/product",component:tt,exact:!0}),r.a.createElement(m.b,{path:"/product/detail",component:rt}),r.a.createElement(m.b,{path:"/product/addupdateitem",component:Ot}),r.a.createElement(m.a,{to:"/home/"}))}}]),t}(n.Component),kt=(a(1245),a(360));function jt(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var xt=kt.a.TreeNode,Ct=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={role:{},AddVisible:!1,AuthVisible:!1,roleNameValue:"",checkedKeys:[]},a.onRow=function(e){return{onClick:function(t){a.setState({role:e,checkedKeys:e.menus})}}},a.showAddModal=function(){a.setState({AddVisible:!0})},a.handleAddRole=function(){var e=a.state.roleNameValue;a.props.getAddRoleStatus(e),a.setState({roleNameValue:"",AddVisible:!1})},a.handleCancel=function(){a.setState({AddVisible:!1})},a.roleNameInput=function(e){a.setState({roleNameValue:e.target.value})},a.showAuthModal=function(){a.setState({AuthVisible:!0})},a.handleAuthRole=function(){var e=Date.now(),t=a.state,n=t.role,r=t.checkedKeys,c=a.props.user.username;a.props.getUpdateRoleAuthStatus(n._id,r,e,c),a.setState({AuthVisible:!1}),a.props.history.replace("/login")},a.handleAuthCancel=function(){a.setState({AuthVisible:!1})},a.getTreeNode=function(e){return e.reduce((function(e,t){return e.push(r.a.createElement(xt,{title:t.title,key:t.key},t.children?a.getTreeNode(t.children):null)),e}),[])},a.onCheck=function(e){a.setState({checkedKeys:e})},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return jt(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:function(e){return jt(e)}},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}],this.treeNodes=this.getTreeNode(Oe)}},{key:"componentDidMount",value:function(){this.props.getRoleList()}},{key:"render",value:function(){var e=this.props.roles,t=this.state,a=t.role,n=t.checkedKeys;if(e.length<=0)return null;var c=r.a.createElement("span",null,r.a.createElement(y.a,{type:"primary",onClick:this.showAddModal},"\u521b\u5efa\u89d2\u8272")," ","\xa0\xa0\xa0",r.a.createElement(y.a,{onClick:this.showAuthModal,disabled:!a._id},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"));return r.a.createElement(_e.a,{title:c},r.a.createElement(Ge.a,{rowKey:"_id",loading:this.state.loading,dataSource:e,columns:this.columns,onRow:this.onRow,rowSelection:{type:"radio",selectedRowKeys:[a._id]},pagination:{defaultPageSize:Ze}}),r.a.createElement(Ce.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:this.state.AddVisible,onOk:this.handleAddRole,onCancel:this.handleCancel,cancelText:"\u5173\u95ed",okText:"\u6dfb\u52a0"},r.a.createElement("span",null,"\u89d2\u8272\u540d\uff1a"),r.a.createElement(E.a,{style:{width:"80%"},value:this.state.roleNameValue,onChange:this.roleNameInput})),r.a.createElement(Ce.a,{title:"\u89d2\u8272\u6743\u9650\u4fee\u6539",visible:this.state.AuthVisible,onOk:this.handleAuthRole,onCancel:this.handleAuthCancel,cancelText:"\u5173\u95ed",okText:"\u4fee\u6539\u6743\u9650"},r.a.createElement("span",null,"\u89d2\u8272\u540d\uff1a"),r.a.createElement(E.a,{style:{width:"80%"},value:this.state.role.name,disabled:!0}),r.a.createElement(kt.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:n,onCheck:this.onCheck},r.a.createElement(xt,{title:"\u6743\u9650\u7ba1\u7406",key:"all"},this.treeNodes))))}}]),t}(n.Component),St=Object(h.b)((function(e){return{roles:e.roles,user:e.user}}),{getRoleList:me,getAddRoleStatus:function(e){return function(t){var a;return k.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,k.a.awrap(L(e));case 2:if(0!==n.sent.status){n.next=9;break}return O.a.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),n.next=7,k.a.awrap(F());case 7:0===(a=n.sent).status?t(ie(a.data)):O.a.error("\u83b7\u53d6\u89d2\u8272\u5217\u8868\u5931\u8d25");case 9:case"end":return n.stop()}}))}},getUpdateRoleAuthStatus:function(e,t,a,n){return function(r){var c;return k.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,k.a.awrap(B(e,t,a,n));case 2:if(0!==s.sent.status){s.next=9;break}return O.a.success("\u4fee\u6539\u89d2\u8272\u6743\u9650\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01"),s.next=7,k.a.awrap(F());case 7:0===(c=s.sent).status?r(ie(c.data)):O.a.error("\u83b7\u53d6\u89d2\u8272\u5217\u8868\u5931\u8d25");case 9:case"end":return s.stop()}}))}}})(Ct),Nt=(a(1247),b.a.Item),It=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={addupdatevisible:!1,delvisible:!1},a.handleAddBtn=function(){a.isAddOrUpdate=!0,a.rowData={},a.setState({addupdatevisible:!0})},a.handleUpdateBtn=function(e){a.isAddOrUpdate=!1,a.setState({addupdatevisible:!0}),console.log(e),a.rowData=e},a.handleDeleteBtn=function(e){a.setState({delvisible:!0}),a.rowData=e,console.log(e)},a.AddOrUpdateUser=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){if(!e){var n=t;n._id=a.rowData._id,a.props.getAddOrUpdateStatus(n),a.setState({addupdatevisible:!1}),a.props.form.resetFields()}}))},a.deleteUser=function(){var e=a.rowData._id;a.props.getDelUserStatus(e),a.setState({delvisible:!1})},a.getRoleList=function(e){return e.map((function(e){return r.a.createElement(He.a.Option,{key:e._id,value:e._id},e.name)}))},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.columns=[{title:"\u7528\u6237Id",dataIndex:"_id",className:"hidden_lie"},{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:function(e){return jt(e)}},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(t){var a=e.props.users.roles.find((function(e){return e._id===t}));return void 0===a?"":a.name}},{title:"\u64cd\u4f5c",render:function(t){return r.a.createElement("span",null,r.a.createElement(Qe,{onClick:function(){return e.handleUpdateBtn(t)}},"\u4fee\u6539"),r.a.createElement(Qe,{onClick:function(){return e.handleDeleteBtn(t)}},"\u5220\u9664"))}}],this.rowData={}}},{key:"componentDidMount",value:function(){this.props.getUserList(),this.props.getRoleList()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.roles,c=a.users;return r.a.createElement(_e.a,{title:r.a.createElement(y.a,{onClick:this.handleAddBtn,type:"primary"},"\u521b\u5efa\u7528\u6237")},r.a.createElement(Ge.a,{dataSource:c.users,columns:this.columns,rowKey:"_id",pagination:{defaultPageSize:Ze}}),r.a.createElement(Ce.a,{title:"Basic Modal",visible:this.state.addupdatevisible,onOk:this.AddOrUpdateUser,onCancel:function(){return e.setState({addupdatevisible:!1})},okText:!0===this.isAddOrUpdate?"\u6dfb\u52a0":"\u66f4\u65b0",cancelText:"\u53d6\u6d88"},r.a.createElement(b.a,{labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(Nt,{label:"\u7528\u6237\u540d"},t("username",{initialValue:this.rowData.username,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5165\u7528\u6237\u540d"}]})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),!0===this.isAddOrUpdate?r.a.createElement(Nt,{label:"\u5bc6\u7801"},t("password",{rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5165\u5bc6\u7801"}]})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))):null,r.a.createElement(Nt,{label:"\u624b\u673a\u53f7"},t("phone",{initialValue:this.rowData.phone,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5165\u7528\u6237\u540d"},{len:11,message:"\u624b\u673a\u53f7\u5fc5\u987b\u4e3a11\u4f4d"}]})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"}))),r.a.createElement(Nt,{label:"\u90ae\u7bb1"},t("email",{initialValue:this.rowData.email,rules:[{required:!0,message:"\u5fc5\u987b\u586b\u5165\u7528\u6237\u540d"}]})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(Nt,{label:"\u6240\u5c5e\u89d2\u8272"},t("role_id",{initialValue:this.rowData.role_id||"\u8bf7\u9009\u62e9\u6240\u5c5e\u89d2\u8272",rules:[{required:!0,message:"\u5fc5\u987b\u9009\u62e9\u7528\u6237\u540d"}]})(r.a.createElement(He.a,null,this.getRoleList(n)))))),r.a.createElement(Ce.a,{title:"Basic Modal",visible:this.state.delvisible,onOk:this.deleteUser,onCancel:function(){return e.setState({delvisible:!1})},okText:"\u5220\u9664",cancelText:"\u53d6\u6d88"},"\u662f\u5426\u5220\u9664"))}}]),t}(n.Component),At=Object(h.b)((function(e){return{roles:e.roles,users:e.users}}),{getRoleList:me,getUserList:function(){return function(e){var t;return k.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k.a.awrap(z());case 2:0===(t=a.sent).status&&e(ue(t.data));case 4:case"end":return a.stop()}}))}},getAddOrUpdateStatus:function(e){return function(t){var a,n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(K(e));case 2:if(0!==(a=r.sent).status){r.next=11;break}return O.a.success("\u64cd\u4f5c\u6210\u529f"),r.next=7,k.a.awrap(z());case 7:0===(n=r.sent).status&&t(ue(n.data)),r.next=12;break;case 11:O.a.error(a.msg);case 12:case"end":return r.stop()}}))}},getDelUserStatus:function(e){return function(t){var a,n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(Y(e));case 2:if(0!==(a=r.sent).status){r.next=11;break}return O.a.success("\u5220\u9664\u6210\u529f"),r.next=7,k.a.awrap(z());case 7:0===(n=r.sent).status&&t(ue(n.data)),r.next=12;break;case 11:O.a.error(a.msg);case 12:case"end":return r.stop()}}))}}})(b.a.create()(It)),_t=b.a.Item,Mt=He.a.Option,Ut=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getItemsValue=function(){return a.props.form.getFieldsValue()},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.categories;return r.a.createElement(b.a,null,r.a.createElement(_t,null,e("parentId",{initialValue:this.props.parentId})(r.a.createElement(He.a,null,r.a.createElement(Mt,{value:this.props.parentId},this.props.parentName),t.map((function(e){return r.a.createElement(Mt,{key:e._id,value:e._id},e.name)}))))),r.a.createElement(_t,null,e("categoryName",{initialValue:""})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Dt=b.a.create()(Ut),Tt=Object(h.b)((function(e){return{categories:e.categories}}),{getCategories:de,getaddCategory:pe})(Dt),Vt=b.a.Item,Pt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getItemsValue=function(){return a.props.form.getFieldsValue()},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(b.a,null,r.a.createElement(Vt,null,e("categoryName",{initialValue:""})(r.a.createElement(E.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Rt=b.a.create()(Pt),Lt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showModal:0},a.getSubcategory=function(e){var t=e._id;a.parentId=t,a.parentName=e.name,a.props.getCategories(t)},a.handleCancel=function(){a.setState({showModal:0})},a.showAddCategory=function(){a.setState({showModal:1}),console.log(a.form)},a.showUpdateCategory=function(e){a.categoryId=e._id,a.setState({showModal:2})},a.handleCreate=function(){var e=a.formRef.getItemsValue();a.props.getaddCategory(e),a.props.getCategories(a.parentId),a.formRef.props.form.resetFields(),a.setState({showModal:0})},a.handleUpdate=function(){var e=a.formRef.getItemsValue().categoryName,t=Object(lt.a)(a).categoryId;a.props.getUpdateCategory({categoryId:t,categoryName:e}),a.props.getCategories(a.parentId),a.setState({showModal:0})},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name",width:"65%"},{title:"\u64cd\u4f5c",render:function(t){return r.a.createElement("span",null,r.a.createElement(Qe,{onClick:function(){e.showUpdateCategory(t)}},"\u4fee\u6539\u5206\u7c7b"),r.a.createElement(Qe,{onClick:function(){e.getSubcategory(t)}},"\u67e5\u770b\u5b50\u5206\u7c7b"))}}],this.loading=!1}},{key:"componentDidMount",value:function(){this.parentId="0",this.props.getCategories(this.parentId),this.parentName="\u603b\u5206\u7c7b"}},{key:"render",value:function(){var e=this,t=this.props.categories,a="0"===this.parentId?this.parentName="\u603b\u5206\u7c7b":this.parentName,n=r.a.createElement("span",null,"0"!==this.parentId?r.a.createElement(y.a,{onClick:function(){return e.props.getCategories(e.parentId="0")},type:"default"},r.a.createElement(v.a,{type:"rollback"}),"\u8fd4\u56de\u603b\u5206\u7c7b"):null,"\u3000\u3000",r.a.createElement(y.a,{type:"primary",onClick:this.showAddCategory},r.a.createElement(v.a,{type:"plus"}),"\u6dfb\u52a0"));t[0]?this.loading=!1:this.loading=!0;var c=t;return r.a.createElement(_e.a,{title:a,extra:n,style:{width:"100%"}},r.a.createElement(Ge.a,{dataSource:c,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:7,showQuickJumper:!0},loading:this.loading,defaultSortOrder:"descend"}),r.a.createElement(Ce.a,{title:"\u6dfb\u52a0\u5546\u54c1",visible:1===this.state.showModal,centered:!0,onOk:this.handleCreate,onCancel:this.handleCancel},r.a.createElement(Tt,{parentId:this.parentId,parentName:this.parentName,addCategory:this.addCategory,wrappedComponentRef:function(t){return e.formRef=t}})),r.a.createElement(Ce.a,{title:"\u4fee\u6539\u5206\u7c7b",visible:2===this.state.showModal,onOk:this.handleUpdate,onCancel:this.handleCancel},r.a.createElement(Rt,{wrappedComponentRef:function(t){return e.formRef=t}})))}}]),t}(n.Component),Ft=Object(h.b)((function(e){return{categories:e.categories}}),{getCategories:de,getaddCategory:pe,getUpdateCategory:function(e){var t=e.categoryId,a=e.categoryName;return function(e){var n;return k.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,k.a.awrap(_({categoryId:t,categoryName:a}));case 2:0===(n=r.sent).status&&e({type:$,data:n});case 4:case"end":return r.stop()}}))}}})(Lt),Bt=ye.a.Content,zt=ye.a.Footer,Kt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){be.a.get("userid")&&this.props.getUserMessage()}},{key:"componentDidMount",value:function(){this.props.user&&O.a.success("\u767b\u5f55\u6210\u529f")}},{key:"render",value:function(){if(!be.a.get("userid"))return r.a.createElement(m.a,{to:"/login"});var e=this.props,t=e.user,a=e.weather,n=t.username;return r.a.createElement(ye.a,{style:{minHeight:"100vh"}},r.a.createElement(xe,null),r.a.createElement(ye.a,null,r.a.createElement(Ie,{username:n,weather:a}),r.a.createElement(Bt,{style:{margin:"0 16px"}},r.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/home",component:ze}),r.a.createElement(m.b,{path:"/category",component:Ft}),r.a.createElement(m.b,{path:"/product",component:wt}),r.a.createElement(m.b,{path:"/role",component:St}),r.a.createElement(m.b,{path:"/user",component:At}),r.a.createElement(m.b,{path:"/charts/bar",component:qe}),r.a.createElement(m.b,{path:"/charts/line",component:We}),r.a.createElement(m.b,{path:"/charts/pie",component:Je}),r.a.createElement(m.a,{to:"home"})))),r.a.createElement(zt,{style:{textAlign:"center"}},"Lychee Backstage \xa92020 Created by cth")))}}]),t}(n.Component),Yt=Object(h.b)((function(e){return{user:e.user}}),{getUserMessage:function(){return function(e){var t;return k.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k.a.awrap(S("/user","GET"));case 2:0===(t=a.sent).code?e((n=t.data,{type:J,data:n})):O.a.error("error");case 4:case"end":return a.stop()}var n}))}}})(Kt),qt=a(122),Wt=a(551),Jt=a(552);var Gt={status:1,data:{pageNum:null,total:null,pages:null,pageSize:null,list:[]}};var Ht=Object(qt.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(st.a)({},t.data,{path:"/"});case W:case J:return Object(st.a)({},t.data);case G:return t.data;default:return e}},weather:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object(st.a)({},t.data);default:return e}},categories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return t.data;default:return e}},addsuccessmsg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return t.data;default:return e}},updatesuccessmsg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return t.data;default:return e}},products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return Object(st.a)({},t.data);default:return e}},productStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:case te:return t.data;default:return e}},roles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return t.data;default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return t.data;default:return e}}}),Qt=Object(qt.createStore)(Ht,Object(Jt.composeWithDevTools)(Object(qt.applyMiddleware)(Wt.a))),Zt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,{store:Qt},r.a.createElement(p.a,null,r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/login",component:ge}),r.a.createElement(m.b,{path:"/admin",component:Yt}),r.a.createElement(m.b,{component:Yt}))))}}]),t}(n.Component);s.a.render(r.a.createElement(Zt,null),document.getElementById("root"))},557:function(e,t,a){e.exports=a(1248)},638:function(e,t,a){},724:function(e,t,a){},725:function(e,t,a){},735:function(e,t,a){}},[[557,1,2]]]);
//# sourceMappingURL=main.7ded2442.chunk.js.map